# Транзакции


`Транзакцией` называется атомарная группа запросов SQL, т.е. которые рассматриваются как единое целое. 
Если подсистема базы данных может выполнить всю группу запросов, она делает это, но если любой из запросов не может быть 
выполнен в результате сбоя или по какой-то другой причине, не будет выполнен ни один запрос группы. 



```r
    Банковское приложение является классическим примером, показываюим, почему необходимы транзакции. 
    Представьте себе банковскую базу данных с двумя таблицами: checking и savings (текущий и сберегательный счета).
    Чтобы переместить $200 с текущего счета клиента банка на его сберегательный счет, вам нужно сделать, по меньшей мере, три шага:
        1. Убедиться, что остаток на текущем счете больше $200.
        2. Вычесть $200 из остатка текущего счета.
        3. Добавить $200 к остатку сберегательного счета.
```

## ACID 
### example
```sql
    START TRANSACTION 
    SELECT balance FROM checking WHERE customer_id = 10233276;
    UPDATE checking SET balance = balance = balance - 200.00 WHERE customer_id = 10233276;
    UPDATE saving SET balance = balance + 200.00 WHERE customer_id = 10233276;
    COMMIT 
```

`Atomicity`  (Атомарность) - Транзакция должна функционировать как единая неделимая единица работы таким образом, 
    чтобы вся транзакция была либо выполнена, либо отменена. Когда транзакции являются атомарными,
    не существует такого понятия как частично выполненная транзакция: все или ничего.

(Эдиный и неделимый результат выполнения транзакции, всё или ничего)

`Consistency`(Непротиворечиво) - База данных должна всегда переходить из одного непротиворечивого состояния в последющее.
    В нашем примере противоречивость гарантирует, что сбой между третьей и четвертой строками не приведет к исчезновению
    $200 с текущего счёта. Поскольку транзакция не будет зафиксирована, ни одно из изменений в этой транзакции не будет отображено в базе данных.

(Переход состояний базы данны записит от выполнения атомарности, база данных или будет отображать результат выполненой транзакции или нет)

`Isolation` (Изолированность) - Результаты транзакции обычно невидимы другим транзакциям, пока она не закончена. 
    Это гарантирует, что если в нашем примере программа суммирования остатков на банковских счетах будет запущена после третьей строки, 
    но перед четвертой, она по-прежнему увидит $200 на текущем счете.

(Последовательность выполнения транзакций - создает область видимости котора гарантирует что следующая транзакция увидеть результаты выполнения предыдущей)

`Durability` (Долговечность) - Будучи зафиксированные, внесенные в ходе транзакции изменения становятся постоянными. Это означает, что изменения
    должны быть записаны так. чтобы данные не могли быть потеряны в случае сбоя системы. Долговечность, однако, является несколько расплывчатой концепцией, поскольку на самом деле существет много уровней. Некоторые стратегии обеспечения долговечности предоставляют более сильные
    гарантиии безопасности, чем другие, и ни одна из них не является надежной на 100%.
(Зависит от стратегии обеспечения долговечности. Зафиксированные изменения в ходе транзакции становятся постоянными.)

```r
Транзакции ACID гарантируют, что банк не потеряет ваши деньги. Вообще очень сложно или даже невозможно сделать это с помощью логики приложения. 
Как и в случае повышения уровня детализации блокировок, оборотной сторонй усиленной безопасности является то, что сервер базы данных должен выполнять больше работы. Сервер базы данных с транзакциями ACID обычнотребует большей мощности процессора, обьема памяти и дискового пространства, чем без них.
Как мы уже упоминали, этот тот самый случай, когда архитектруа подсистем хранения данных MySQL оказывается благом.
```
